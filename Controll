    @GetMapping("/download-results")
    public void downloadResults(HttpServletResponse response) throws IOException {
        byte[] resultFile = excelService.generateResultFile();
        
        response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
        response.setHeader("Content-Disposition", "attachment; filename=upload_results.xlsx");
        response.getOutputStream().write(resultFile);
        response.flushBuffer();
    }

    // Option 2: If you must do it in one request (Not recommended)
    @PostMapping("/upload-and-download")
    public void handleFileUploadAndDownload(@RequestParam("file") MultipartFile file,
                                         HttpServletResponse response) throws IOException {
        try {
            List<BankAccountUploadResult> results = excelService.processExcelFile(file);
            byte[] resultFile = excelService.generateResultFile(results);
            
            response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
            response.setHeader("Content-Disposition", "attachment; filename=upload_results.xlsx");
            response.getOutputStream().write(resultFile);
            response.flushBuffer();
        } catch (Exception e) {
            response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, 
                            "Error processing file: " + e.getMessage());
        }
    }
}
